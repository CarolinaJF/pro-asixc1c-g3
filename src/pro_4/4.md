# pro-asixc1c-g3

# üìò **THE CURE PROJECT** üßë‚ÄçüíªüöÄ 
Tambi√©n conocido como "pro-asixc1c-g3".

# Nuestro sitio todav√≠a est√° en construcci√≥n üößüèóÔ∏èüèöÔ∏è

# Dise√±o e implementaci√≥n de la base de datos para InnovateTech

Hemos dise√±ado e implementado una base de datos completa para la gesti√≥n del personal, adaptada a los requisitos actuales del sector y conforme al convenio colectivo vigente en el √°mbito de la consultor√≠a, tecnolog√≠as de la informaci√≥n y estudios de mercado y opini√≥n p√∫blica.

El sistema contempla los siguientes elementos clave:

* Gesti√≥n de empleados

Cada empleado queda registrado mediante su DNI o NIE. Adem√°s se registra su nombre, apellido, direcci√≥n, tel√©fono, puesto de trabajo, fecha de alta en el sistema de la empresa y su estado: si est√° activo o no.

* Estructura departamental

Los empleados est√°n asignados a un departamento espec√≠fico. Cada departamento se identifica mediante una id y contiene informaci√≥n detallada como el nombre completo y tel√©fono de contacto del departamento.

* Categor√≠a

Cada empleado est√° asociado a un grupo_nivel dependiendo seg√∫n el convenio al que pertenecen. Sin embargo, el grupo_nivel no identifica a los empleados en este caso, ya que contamos con empleados de otras √°reas y eso har√≠a que la identificaci√≥n no fuera √∫nica violando as√≠ uno de los principios de integridad de los datos. La nomenclatura, que s√≠ es un dato √∫nico en este caso, es el identificador que asocia a cada empleado con su salario, per√≠odo de prueba, vacaciones y su grupo_nivel.

* Adaptaci√≥n normativa

La base de datos ha sido desarrollada teniendo en cuenta que debe incluir al menos un empleado representativo de cada grupo_nivel contemplado en el √°rea 2 del convenio sectorial. Toda la informaci√≥n salarial, de vacaciones y condiciones de prueba se ha introducido de acuerdo con las disposiciones de dicho convenio, actualizadas al a√±o 2025.

Adem√°s del dise√±o conceptual y l√≥gico (modelo entidad-relaci√≥n y su transformaci√≥n al modelo relacional), se ha realizado la implementaci√≥n t√©cnica de la base de datos en un sistema gestor de bases de datos PostgreSQL, incluyendo la carga de un volumen representativo de datos para permitir pruebas reales y an√°lisis funcionales.

Esta soluci√≥n permite una gesti√≥n eficaz, escalable y conforme a la normativa laboral vigente, ofreciendo una herramienta fiable para el control y seguimiento del personal de su empresa.

# Dise√±o conceptual

Despu√©s de haber entrevistado a los responsables de la empresa InnovateTech, hemos dise√±ado el siguiente modelo conceptual para su base de datos. 

## Entidades

Hemos identificado tres entidades clave para esta base de datos. Por un lado tenemos los empleados que representan a los trabajadores de la empresa. La empresa quiere identificarlos por su DNI por lo tanto, hemos considerado que DNI deber√° ser el identificador, aunque hemos pensado que ser√≠a mejor llamarle id ya que haremos que al insertar datos dentro de este atributo siga el est√°ndar de los DNI y los NIE.

Adem√°s del identificador hemos a√±adido los datos que son requeridos por la empresa y nosotros, bajo aprobaci√≥n del responsable de la empresa, hemos considerado √∫til para el gestor de base de datos que se a√±adan los atributos fecha_alta y si el empleado est√° activo o no.

A su vez, estos empleados tienen asignada una categor√≠a profesional de acuerdo al convenio que se les aplica en funci√≥n del rol que desempe√±an en esta empresa. Como la empresa quiere adem√°s a√±adir ciertos atributos a cada una de las categor√≠as profesionales, esta se convierte en una entidad. Como ya hemos comentado anteriormente y bajo aprobaci√≥n del responsable de la empresa, hemos declarado la nomenclatura definida en el convenio como identificador de cada una de las categor√≠as que queremos guardar en la base de datos y hemos implementado el resto de datos que nos requiere la empresa, en este caso: grupo_nivel, salario, periodo_prueba y vacaciones. Los datos insertados en cada uno de estos atributos han sido minuciosamente identificados y verificados con los datos presentes en el convenio de 2025. 

Cabe destacar que nomenclatura es el dato que se ha declarado para relacionar la tabla que contiene los datos de las categor√≠as con cada uno de los empleados que tiene la empresa, as√≠ cada empleado tendr√° a su vez su propia nomenclatura, grupo_nivel, salario, periodo de prueba y vacaciones.

Por √∫ltimo, cada uno de los empleados tiene un solo departamento asignado y a su vez de cada uno de los departamentos necesitamos registrar valores como el nombre completo y el tel√©fono. Por ello, hemos convertido departamentos en una entidad con diferentes atributos. Para asociar cada departamento a su usuario, hemos insertado un id que ser√° serial.

En resumen, necesitamos de las entidades departamento y categor√≠a para conectar los valores departamento o tel√©fono de departamento y salario o vacaciones con la entidad empleados.

## Representaci√≥n del dise√±o de la base de datos gestion_personal para InnovateTech

![Diagrama representativo gestion_personal](img4/diagrama.png)

En la tabla empleados contaremos con una clave primaria que ser√° id, esta identificar√° de manera equ√≠voca a los empleados por su DNI o NIE. Tambi√©n contaremos con las siguientes claves for√°neas siguiendo la regla de integridad referencial: 
Codigo_cat: esta es la clave for√°nea que conecta a cada uno de los empleados con valores como son el grupo_nivel, salario, periodo de prueba y las vacaciones. Codigo_cat es a su vez la clave primaria de la tabla categor√≠a y en dicha tabla es denominada nomenclatura. Es una clave √∫nica e irrepetible seg√∫n los datos encontrados en el convenio colectivo bajo el que se rigen los trabajos de los empleados de esta empresa en concreto. 
Id_dpt: esta es la clave for√°nea que relaciona a cada empleado con su departamento. Esta clave for√°nea es a su vez clave primaria en la entidad que contiene todos los datos requeridos de cada uno de los departamentos como son el nombre y el tel√©fono. Esta clave primaria en la entidad departamento es llamada id.

En cuanto al grado de relaci√≥n aunque hay tres entidades, todas las relaciones son binarias (grado dos) porque cada relaci√≥n conecta solo dos entidades a la vez y no hay una relaci√≥n que involucre simult√°neamente a las tres entidades (empleado, departamento, y categor√≠a en una √∫nica relaci√≥n de grado tres). 
Para que fuera grado de relaci√≥n ternaria tendr√≠a que enfocarse de tal forma que para que un empleado est√© en una categor√≠a espec√≠fica tiene que estar dentro de un departamento espec√≠fico. Este no es el caso, tenemos empleados que pertenecen a departamentos diferentes pero est√°n la misma categor√≠a. 

La relaci√≥n que encontramos entre empleado y departamento es de 1:N. Un empleado puede tener tan solo un departamento a la vez mientras que un departamento puede tener muchos empleados a la vez. 
La relaci√≥n que existe entre empleados y categor√≠a tambi√©n es de 1:N. Un empleado puede pertenecer √∫nicamente a una categor√≠a mientras que una categor√≠a puede albergar muchos empleados a la vez.

Como m√≠nimo, la tabla empleados deber√° contener estos datos: un empleado por cada uno de las categor√≠as existentes en el √°rea 2 del convenio de aplicaci√≥n.

| id PK       | codigo_cat FK | id_dpt FK | nom       | apellidos           | direccion                                                  | telefono     | puesto                                                                                  |
|------------|--------------|----------|-----------|----------------------|-------------------------------------------------------------|--------------|-----------------------------------------------------------------------------------------|
| 12345678Z  | A2GAN1       | 8        | Marta     | Echevarr√≠a G√≥mez     | Calle Arriaga 15, 3¬∫A, 48001 Bilbao                         | 612 345 678  | Jefe/a de CAU, Coordinador/a de Atenci√≥n T√©cnica                                       |
| 87654321X  | A2GBN1       | 4        | Iker      | L√≥pez Ruiz           | Avenida Zabalbide 77, 1¬∫D, 48006 Bilbao                     | 633 987 654  | T√©cnico/a soporte nivel 2, Analista de incidencias                                     |
| 11223344L  | A2GBN2       | 4        | Leire     | Gonz√°lez Arana       | Paseo Uribitarte 28, 2¬∫B, 48001 Bilbao                      | 655 432 198  | T√©cnico/a soporte nivel 1, Agente senior Helpdesk                                      |
| 99887766H  | A2GCN1       | 5        | Diego     | Romero Souto         | Calle do Franco 34, 2¬∫E, 15702 Santiago de Compostela       | 621 654 321  | Agente atenci√≥n al usuario, Gestor/a de tickets                                        |
| 55667788P  | A2GCN2       | 4        | Paula     | Fern√°ndez Otero      | R√∫a das Hortas 5, 1¬∫C, 15705 Santiago de Compostela         | 634 876 543  | Auxiliar de soporte, Operador/a de incidencias                                         |
| 33445566T  | A2GCN3       | 5        | Sergio    | Fern√°ndez Gil        | Plaza Mayor 3, 4¬∫D, 47001 Valladolid                        | 611 223 344  | Back office atenci√≥n cliente, Auxiliar CAU                                             |
| 76543210M  | A2GDN1       | 5        | Manuel    | Castro Varela        | Avenida de Lugo 88, 4¬∫B, 15703 Santiago de Compostela       | 699 998 877  | Auxiliar administrativo Helpdesk, Atenci√≥n presencial                                  |
| 44556677S  | A2GDN2       | 5        | Sara      | Jim√©nez Lorente      | Calle Alfonso I, 21, 2¬∫A, 50003 Zaragoza                    | 688 334 221  | Agente de recepci√≥n de solicitudes                                                      |
| 22334455K  | A2GDN3       | 5        | Javier    | Navarro Pardo        | Avenida Goya 66, 5¬∫D, 50005 Zaragoza                        | 677 123 789  | Telefonista, Registro de incidencias iniciales                                         |
| 66778899J  | A2GEN1       | 9        | Carmen    | Lafuente Gracia      | Calle del Coso 112, 3¬∫B, 50001 Zaragoza                     | 677 998 211  | Auxiliar de archivo o entrada de datos en CAU                                          |
| 611234567L | A2GEN2       | 5        | Alejandro | Serrano Biel         | Paseo Independencia 45, 6¬∫C, 50004 Zaragoza                 | 655 990 123  | Auxiliar junior en atenci√≥n al cliente (sin experiencia)                               |


Como m√≠nimo, la tabla categoria deber√° contener estos datos.

| nomenclatura PK | grupo_nivel | salario     | periodo_prueba | vacaciones |
|--------------|-------------|-------------|----------------|------------|
| A2GAN1       | A1          | 22.246,16 ‚Ç¨  | 6 meses        | 23 d√≠as    |
| A2GBN1       | B1          | 20.377,72 ‚Ç¨  | 6 meses        | 23 d√≠as    |
| A2GBN2       | B2          | 18.485,91 ‚Ç¨  | 6 meses        | 23 d√≠as    |
| A2GCN1       | C1          | 17.346,87 ‚Ç¨  | 4 meses        | 23 d√≠as    |
| A2GCN2       | C2          | 17.056,00 ‚Ç¨  | 4 meses        | 23 d√≠as    |
| A2GCN3       | C3          | 16.976,00 ‚Ç¨  | 4 meses        | 23 d√≠as    |
| A2GDN1       | D1          | 16.896,00 ‚Ç¨  | 3 meses        | 23 d√≠as    |
| A2GDN2       | D2          | 16.816,00 ‚Ç¨  | 3 meses        | 23 d√≠as    |
| A2GDN3       | D3          | 16.736,00 ‚Ç¨  | 3 meses        | 23 d√≠as    |
| A2GEN1       | E1          | 16.656,00 ‚Ç¨  | 3 meses        | 23 d√≠as    |
| A2GEN2       | E2          | 16.576,00 ‚Ç¨  | 3 meses        | 23 d√≠as    |


Como hemos contemplado que contar√°n con empleados pertenecientes a otras √°reas, nuestra tabla contempla datos del √°rea 6, 4 y 1.

Tabla departamento.

| id (SERIAL) PK | nom                         | telefono      |
|----------------|-----------------------------|---------------|
| 1              | Recursos Humanos            | 912345000     |
| 2              | Administraci√≥n              | 912345001     |
| 3              | Finanzas                    | 912345002     |
| 4              | Soporte T√©cnico             | 912345003     |
| 5              | Atenci√≥n al Cliente         | 912345004     |
| 6              | Mark√©ting y Comunicaci√≥n    | 912345005     |
| 7              | Direcci√≥n General           | 912345006     |
| 8              | Consultor√≠a y Proyectos     | 912345007     |
| 9              | Estudios de mercado         | 912345008     |


Por razones de seguridad, las relaciones entre tablas han sido restringidas de modo que si se intenta hacer una actualizaci√≥n en las tablas categor√≠a o departamento, esa actualizaci√≥n ser√° replicada en la tabla de empleados. Sin embargo, si alguien borra uno de estos datos de una de estas tablas, la supresi√≥n ser√° bloqueada y no se podr√° llevar a cabo.

## Implementaci√≥n de la base de datos en PostgreSQL: 
Como estamos en un entorno de producci√≥n, aunque este sea ficticio, creemos que no ser√≠a aceptable que nuestra base de datos estuviera dentro de la base de datos postgres. Por ello, hemos creado una base de datos espec√≠fica para la gesti√≥n de personal, que es el caso que se nos ha proporcionado.

Hemos elegido PostgreSQL como sistema gestor de base de datos relacional y pgAdmin4 porque son el SGBD y la interfaz gr√°fica con la que solemos trabajar en nuestra empresa. La hemos implementado en multitud de proyectos exitosos y nos genera confianza.

Una vez tenemos instalado postgresql, accedemos a pgadmin4 desde cualquier navegador:

![Login](img4/2.png)


![db](img4/3.png)

Una vez dentro, primero hemos creado un usuario que tendr√° el rol de gestor de la base de datos: db_admin.

![db_admin](img4/4.png)

Despu√©s hemos creado nuestra base de datos que albergar√° nuestras tablas cuyo propietario ser√° db_admin.

![db2](img4/5.png)

![db2](img4/6.png)

Nos conectamos a nuestro usuario gestor para poder seguir con la implementaci√≥n de nuestra base de datos:

![db2](img4/1.png)

Ahora, con la base de datos creada, podremos crear las tablas que nos ha solicitado InnovateTech.

Creaci√≥n de la tabla departamento:

![dpt](img4/7.png)

Para evitar departamentos duplicados:

![dpt1](img4/8.png)

Inserci√≥n de datos:

![dpt2](img4/9.png)

Resultado tabla departamento:

![dpt3](img4/10.png)

Creaci√≥n de la tabla categoria:

![cat1](img4/11.png)

Inserci√≥n de datos:

![cat2](img4/13.png)

Creaci√≥n de la tabla empleados:

![em1](img4/14.png)

Inserci√≥n de datos:

![em2](img4/15.png)

Despu√©s hemos abierto la restricci√≥n de la clave primaria para que tambi√©n podamos insertar NIE y cambiamos el nombre de la columna de DNI a id.

![em3](img4/16.png)


## Creaci√≥n de los roles
Planteamiento de gesti√≥n de los usuarios que tendremos en nuestra base de datos. Contaremos con 4 tipos de roles en la base de datos.
En resumen estos ser√°n los roles que tendr√°n los usuarios:

| Rol           | SELECT | INSERT | UPDATE | DELETE | CREATETABLE | DROPTABLE | ACCESO                          |
|---------------|--------|--------|--------|--------|-------------|-----------|----------------------------------|
| rol_admin     | S√≠     | S√≠     | S√≠     | S√≠     | S√≠          | S√≠        | Completo                        |
| rol_rrhh      | S√≠     | S√≠     | S√≠     | No     | S√≠          | No        | Todas las tablas de gestion_personal |
| rol_jefe      | S√≠     | No     | No     | No     | No          | No        | Solo lectura                    |
| rol_empleado  | No     | No     | No     | No     | No          | No        | Solo sus datos                 |

* rol_admin
Usuario asignado: db_admin.


Ser√° el gestor de la base de datos, este tendr√° todos los permisos necesarios para la gesti√≥n de la base de datos. Ser√° el superadmin, podr√° crear tablas, eliminarlas, seleccionar informaci√≥n y actualizarla.


Ejemplo de creaci√≥n de rol en pgAdmin4:

![rol1](img4/17.png)

![rol2](img4/18.png)

![rol3](img4/19.png)

* rol_rrhh


Usuario asignado: rrhh_manager.


Ser√° un empleado de recursos humanos que podr√° ver, a√±adir y actualizar todas las tablas de esta base de datos y crear nuevas tablas. No obstante, no podr√° borrar tablas. 


* rol_jefe

  
Usuario asignado: jefe1.

Este rol corresponde al rol de jefe o manager. Est√° dedicado a cualquiera de los usuarios de mi base de datos que gestiona o tenga empleados que supervisar.
Los usuarios de este rol tan solo podr√°n visualizar informaci√≥n. Para cualquier actualizaci√≥n en la base de datos deber√°n dirigirse a cualquiera de los encargados de la base de datos dentro del departamento de recursos humanos.

* rol_empleado

  
Usuario asignado: 87654321X

Es el rol dedicado a cada uno de los empleados de la empresa. Estos usar√°n su DNI o NIE para entrar en la base de datos y hemos implementado una soluci√≥n para que solo puedan ver sus datos personales: creaci√≥n de vistas espec√≠ficas.

![rol4](img4/20.png)

![rol5](img4/21.png)

![rol6](img4/22.png)

Los empleados solo tendr√°n permisos para visualizar sus propios datos. No tendr√°n acceso a ninguna tabla a menos que la visualicen con la vista que hemos creado.

![rol7](img4/23.png)

![rol8](img4/24.png)

Resumen de los permisos concedidos con los roles: 
Vemos que el rol de empleado no tiene ning√∫n permiso, excepto el de la vista que le hemos creado espec√≠ficamente y asignado.

![rol9](img4/25.png)


El resto de usuarios han sido creados despu√©s de haber creado y configurado el rol al que pertenecen. La asignaci√≥n del rol ha sido realizada de la misma forma que para los usuarios que son empleados.

