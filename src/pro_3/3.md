<a name="inicio"></a>


<h1 style="color: red; text-align: center; font-family: 'Montserrat', sans-serif; font-weight: bold; font-size: 64px;">THE CURE</h1>


## √çndice de Servicios complementarios:
 
1. [Servicio DNS y Web](#servicio-dns-y-web)  
2. [Servicio FTP](#Servicio-FTP)  
3. [Servicio de Chatbot para Soporte T√©cnico y Atenci√≥n al Cliente](#Servicio-de-Chatbot-para-Soporte-T√©cnico-y-Atenci√≥n-al-Cliente)

---

# Servicios desplegados

Adem√°s de la puesta en marcha de los servicios b√°sicos de AOD, VOD y base de datos, la empresa InnovateTech nos ha solicitado la implementaci√≥n de cuatro servicios complementarios. 

Hemos elegido los servicios de DNS, Web, FTP y Chatbot. El servicio DNS es fundamental para la accesibilidad del sistema, ya que permite acceder a los recursos por nombre de dominio en lugar de direcciones IP. Se opt√≥ por **DuckDNS** por ser una soluci√≥n gratuita, confiable y especialmente √∫til para IPs din√°micas, como las de instancias en la nube de bajo costo.

El servidor web se implement√≥ con **Nginx** por su alto rendimiento, bajo consumo de recursos y compatibilidad con m√≥dulos como **RTMP** y **HLS**, fundamentales para la transmisi√≥n en tiempo real. Nginx tambi√©n facilita la configuraci√≥n de HTTPS, redirecciones, alias y control de acceso.

El servicio FTP fue incluido para facilitar la **gesti√≥n remota de archivos multimedia**, especialmente en etapas de prueba y administraci√≥n del contenido. Se eligi√≥ por su simplicidad, versatilidad en el almacenamiento de archivos de gran tama√±o, amplia compatibilidad con herramientas cliente (como FileZilla) y facilidad de configuraci√≥n.

Por √∫ltimo, con el objetivo de proporcionar una experiencia interactiva al usuario, se incluy√≥ un **chatbot como sistema de asistencia en l√≠nea**. Este componente est√° pensado para:

- Resolver dudas frecuentes sobre el funcionamiento del sistema.
- Guiar a los usuarios en la navegaci√≥n de la plataforma.
- Servir como canal de comunicaci√≥n con el equipo t√©cnico en futuras fases.

---


# Servicio DNS y Web

Este apartado presenta la metodolog√≠a y desarrollo t√©cnico llevado a cabo para implementar un sistema de transmisi√≥n en vivo de video y audio utilizando tecnolog√≠as web modernas, con √©nfasis en la accesibilidad, simultaneidad de servicios, y despliegue seguro v√≠a HTTPS. Esta iniciativa corresponde a un proyecto transversal de car√°cter investigativo y demostrativo.


<div style="text-align: center;">
  <iframe src="https://drive.google.com/file/d/1_ABoTF8Z2VaI-9dUMX8Fdky6KTa0HdPZ/preview" 
          width="640" height="360" allow="autoplay" allowfullscreen></iframe>
</div>


## Configuraci√≥n del DNS

El Sistema de Nombres de Dominio (DNS) permite asociar direcciones IP con nombres de dominio legibles para los humanos. DuckDNS es un proveedor de DNS din√°mico gratuito que facilita la asignaci√≥n de una IP din√°mica a un nombre de dominio personalizado.

**BIND9** (Berkeley Internet Name Domain) es el servidor DNS m√°s utilizado en sistemas UNIX y Linux. Permite crear zonas autoritativas personalizadas, resolver nombres de dominio en redes internas o externas, y proporciona un control completo sobre la infraestructura DNS. BIND9 se configura mediante archivos planos, y soporta tanto zonas directas (A/AAAA) como inversas (PTR).

## Implementaci√≥n

Se instal√≥ y configur√≥ BIND9 como servidor DNS autoritativo, adem√°s se cre√≥ una zona directa personalizada (**db.innovatetech.duckdns.org**) con sus respectivos registros A, CNAME y NS.

Definimos la zona en `/etc/bind/named.conf.local` y asignamos el dominio `innovatetech.duckdns.org` a la IP p√∫blica de la instancia de AWS.

```dns
$TTL    604800
@       IN      SOA     innovatech.duckdns.org. admin.innovatech.duckdns.org. (
                              2024052101 ; Serial
                              604800     ; Refresh
                              86400      ; Retry
                              2419200    ; Expire
                              604800 )   ; Negative Cache TTL
;
@       IN      NS      innovatech.duckdns.org.
@       IN      A       34.204.yy.xx
www     IN      A       34.204.yy.xx
video.innovatetech.duckdns.org.    IN    A    13.219.yy.xx
```
La arquitectura del proyecto est√° basada en instancias virtuales de AWS EC2 que permiten un entorno flexible y escalable para servicios web, procesamiento multimedia y servidor de medios.

## Componentes

- **Instancia principal (nginx + RTMP):**  
  Encargada de servir la web, el stream y actuar como servidor RTMP.

- **Instancia secundaria (env√≠o de contenido):**  
  Usada para convertir, codificar y enviar streams mediante FFmpeg.

## Estructura de la P√°gina Web

El front-end se basa en **HTML5**, **CSS3** y **JavaScript**, utilizando una plantilla *responsive* adaptada a servicios multimedia.

### Organizaci√≥n de Archivos

- `/index.html`: P√°gina principal con enlaces a los m√≥dulos.
- `/masonry.html`: M√≥dulo de video en vivo.
- `/grid.html`: M√≥dulo de audio en vivo.
- `/about.html`: Descripci√≥n institucional.
- `/single-post.html`: Chatbot y asistencia (placeholder).

## Herramientas Utilizadas

- **Bootstrap**, **FontAwesome**, **Google Fonts**
- **HLS.js** para visualizaci√≥n HLS

## Servicios Multimedia: Audio y Video

Se utiliz√≥ **FFmpeg** para codificar y emitir los contenidos a trav√©s de:

- **RTMP** para video en vivo.
- **HLS** para video/audio segmentado.

La arquitectura contempla **simultaneidad de servicios** mediante rutas independientes en **nginx**.

## Configuraci√≥n de Nginx (`nginx.conf`)

A continuaci√≥n se muestra la configuraci√≥n de los bloques `location` para servir los contenidos HLS (audio y video):

```nginx
location /hls/audio/ {
  alias /tmp/hls/audio/;
  types {
    application/vnd.apple.mpegurl m3u8;
    video/mp2t ts;
  }
  add_header Cache-Control no-cache;
  add_header Access-Control-Allow-Origin *;
}

location /hls/stream/ {
  alias /tmp/hls/stream/;
  types {
    application/vnd.apple.mpegurl m3u8;
    video/mp2t ts;
  }
  add_header Cache-Control no-cache;
  add_header Access-Control-Allow-Origin *;
}
```

# Configuraci√≥n RTMP (`nginx.conf` - m√≥dulo RTMP)

Configuraci√≥n de las aplicaciones RTMP en Nginx para habilitar transmisi√≥n en vivo de audio y video utilizando HLS:

```nginx
application audio {
  live on;
  record off;
  hls on;
  hls_path /tmp/hls/audio;
  hls_fragment 3s;
  hls_playlist_length 10s;
}

application stream {
  live on;
  record off;
  hls on;
  hls_path /tmp/hls/stream;
  hls_fragment 3s;
  hls_playlist_length 10s;
}
```

## Separaci√≥n de Servicios y Simultaneidad

### Problema Detectado

Inicialmente, el audio y el video compart√≠an una misma ruta de salida (`/tmp/hls`), lo que generaba **conflictos en la reproducci√≥n simult√°nea** de ambos servicios.

### Soluci√≥n Aplicada

- Separaci√≥n en subdirectorios: `/tmp/hls/audio` y `/tmp/hls/stream`.
- Asignaci√≥n de **alias distintos** en la configuraci√≥n de Nginx.
- Ajuste de permisos de cada directorio para permitir la lectura desde el servidor web.

### HTTPS con Certificado SSL

HTTPS asegura las comunicaciones entre cliente y servidor. Se us√≥ inicialmente OpenSSL para certificados autofirmados, y luego Let's Encrypt para certificados v√°lidos.

### Proceso con OpenSSL (utilizado inicialmente)

```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/ssl/private/nginx-selfsigned.key \
  -out /etc/ssl/certs/nginx-selfsigned.crt
```

### Implementaci√≥n Let's Encrypt

- Instalaci√≥n Certbot: `sudo apt install certbot python3-certbot-nginx`.
- Ejecuci√≥n: `sudo certbot --nginx -d innovatetech.duckdns.org`.
- Renovaci√≥n autom√°tica: `sudo systemctl enable certbot.timer`.

### Configuraci√≥n HTTPS en nginx

```nginx
server {
  listen 443 ssl;
  server_name innovatetech.duckdns.org;
  ssl_certificate /etc/letsencrypt/live/innovatetech.duckdns.org/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/innovatetech.duckdns.org/privkey.pem;
  include ssl-params.conf;
  ...
}
```

## Servicio de Inicializaci√≥n de Carpetas HLS

Las carpetas ubicadas en `/tmp` son eliminadas en cada reinicio del sistema, por lo que es necesario regenerarlas autom√°ticamente, para ello se cre√≥ un script .sh el cual se cree un servicio de creacion y configuracion de carpetas ejecutable junto con el encendido del equipo servidor.

### Script `setup-hls-init.sh`

```bash
#!/bin/bash

# üîß Instalando servicio de inicializaci√≥n para carpetas HLS...

# 1. Crear el script de inicializaci√≥n
cat << 'EOF' | sudo tee /usr/local/bin/init-hls.sh > /dev/null
#!/bin/bash

# Crear carpetas necesarias
mkdir -p /tmp/hls/stream
mkdir -p /tmp/hls/audio

# Asignar permisos y propietario
chown -R nobody:nogroup /tmp/hls
chmod -R 755 /tmp/hls

echo "[init-hls] Carpetas HLS creadas correctamente."
EOF

# 2. Hacerlo ejecutable
sudo chmod +x /usr/local/bin/init-hls.sh

# 3. Crear el servicio systemd
cat << EOF | sudo tee /etc/systemd/system/init-hls.service > /dev/null
[Unit]
Description=Inicializar carpetas HLS en /tmp
After=network.target

[Service]
Type=oneshot
ExecStart=/usr/local/bin/init-hls.sh
RemainAfterExit=true

[Install]
WantedBy=multi-user.target
EOF

# 4. Recargar systemd y habilitar servicio
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl enable init-hls.service

# 5. Ejecutar el servicio inmediatamente
sudo systemctl start init-hls.service

# 6. Mostrar estado
sudo systemctl status init-hls.service --no-pager

echo "‚úÖ Servicio de inicializaci√≥n de carpetas HLS instalado correctamente."
```

## Consideraciones finales del servicio de web y DNS

Este proyecto demuestra la implementaci√≥n de una soluci√≥n robusta de transmisi√≥n multimedia en tiempo real utilizando tecnolog√≠as libres y de c√≥digo abierto, sobre infraestructura flexible y segura. El sistema soporta m√∫ltiples transmisiones simult√°neas gracias a su separaci√≥n de rutas, y asegura integridad y privacidad gracias a HTTPS.

La estructura final permite extender el sistema a nuevos m√≥dulos (radio, eventos, control de usuarios, anal√≠tica) sin redise√±ar la base.


---

# Servicio FTP

La implementaci√≥n de un servidor FTP en un entorno cloud como AWS EC2 requiere una planificaci√≥n meticulosa para garantizar no solo la transferencia eficiente de archivos multimedia, sino tambi√©n su integraci√≥n en un flujo de trabajo de retransmisi√≥n en vivo. ProFTPD se selecciona por su capacidad para manejar conexiones simult√°neas y su flexibilidad en la configuraci√≥n de permisos, esencial para entornos donde m√∫ltiples usuarios interact√∫an con contenido cr√≠tico. A continuaci√≥n profundizaremos en cada etapa t√©cnica, justificando decisiones de dise√±o y vincul√°ndolas con los requisitos operativos de una plataforma de streaming.


## Configuraci√≥n Inicial de la Instancia EC2

Antes de instalar cualquier servicio, es fundamental preparar el sistema operativo. En AWS, una instancia EC2 con Ubuntu Server 24.04 LTS ofrece un equilibrio entre estabilidad y acceso a paquetes actualizados. La actualizaci√≥n del sistema mediante **sudo apt update && sudo apt upgrade -y** no solo aplica parches de seguridad, sino que tambi√©n asegura compatibilidad con bibliotecas cr√≠ticas como OpenSSL, necesarias para protocolos cifrados como FTPS. Un reinicio posterior (**sudo reboot**) garantiza que los cambios en el kernel‚Äîesenciales para optimizar el rendimiento de red‚Äîse activen correctamente. Este paso previo mitiga riesgos como vulnerabilidades conocidas o incompatibilidades de software.

## Estructura de Directorios y Gesti√≥n de Usuarios

La creaci√≥n de directorios bajo **/var/ftp/innovatetech** (pelis, series, musica, admin) organiza el contenido seg√∫n su tipo, facilitando su gesti√≥n posterior. Asignar el usuario innovatetech_admin y el grupo innovatech como propietarios mediante **sudo chown -R innovatetech_admin:innovatech /var/ftp/innovatetech** establece una jerarqu√≠a clara: los administradores tienen control total, mientras que los usuarios regulares heredan permisos restringidos. El comando **sudo chmod g+s /var/ftp/innovatetech** asegura que los nuevos archivos creados en estos directorios hereden autom√°ticamente el grupo innovatech, evitando errores de permisos en futuras subidas. Este enfoque es crucial en entornos colaborativos, donde m√∫ltiples administradores pueden necesitar acceder a los mismos recursos sin comprometer la seguridad.

## Configuraci√≥n Detallada de ProFTPD

El archivo **/etc/proftpd/proftpd.conf** act√∫a como el n√∫cleo de la configuraci√≥n del servidor. La directiva MasqueradeAddress 34.233.187.138 (sustituyendo por la IP el√°stica de AWS) resuelve un problema com√∫n en entornos cloud: cuando el servidor FTP est√° detr√°s de un NAT, los clientes externos pueden recibir direcciones IP internas en las respuestas del modo pasivo, lo que interrumpe las transferencias. Al especificar la IP p√∫blica, se fuerza al servidor a anunciar la direcci√≥n correcta, asegurando que los puertos pasivos (49152-65534) sean accesibles externamente.
La secci√≥n **<Directory /var/ftp/innovatetech>** con **<Limit WRITE>** restringe operaciones de escritura al grupo innovatech, una medida de seguridad que previne modificaciones no autorizadas. Esto es particularmente relevante en plataformas de streaming, donde el contenido debe permanecer intacto hasta su procesamiento automatizado. La activaci√≥n de FTPS mediante TLSEngine on y la vinculaci√≥n de certificados SSL (TLSCertificateFile) protege las credenciales y los datos en tr√°nsito, cumpliendo con est√°ndares como PCI DSS para entornos que manejan informaci√≥n sensible.

## Integraci√≥n con el Flujo de Retransmisi√≥n

A efecto te√≥rico, el servidor FTP no opera en aislamiento. Los archivos subidos a **/var/ftp/innovatetech/pelis** suelen requerir procesamiento antes de su transmisi√≥n. Un script de Bash utilizando **FFmpeg (ffmpeg -i entrada.mp4 -c:v libx264 salida.m3u8)** convierte videos a formatos adaptativos como HLS, permitiendo streaming eficiente en diferentes calidades seg√∫n el ancho de banda del usuario. Este script puede automatizarse con herramientas como inotifywait, que monitorea el directorio FTP y dispara conversiones ante nuevas subidas, creando un pipeline continuo desde la carga hasta la distribuci√≥n.

La elecci√≥n de NGINX con el m√≥dulo RTMP para el streaming final se debe a su eficiencia en la entrega de video en tiempo real. Configuraciones como allow publish 127.0.0.1 en NGINX restringen la publicaci√≥n de streams al propio servidor, evitando que fuentes externas comprometan la integridad del sistema. Este flujo‚ÄîFTP para ingesti√≥n, FFmpeg para procesamiento, NGINX para distribuci√≥n‚Äîconstituye una arquitectura escalable, capaz de manejar desde peque√±as emisoras hasta plataformas con miles de usuarios concurrentes.

## Estrategias de Mantenimiento y Resiliencia

La implementaci√≥n de backups automatizados en AWS S3 mediante aws s3 sync protege contra p√©rdidas de datos por fallos hardware o corrupci√≥n de archivos. Programar esta tarea v√≠a cron garantiza que los backups se ejecuten diariamente sin intervenci√≥n manual. Paralelamente, herramientas como NetData ofrecen monitoreo en tiempo real de m√©tricas clave: uso de CPU durante conversiones de video, ancho de banda consumido por FTP, o latencia en la entrega de streams. Esta visibilidad permite detectar cuellos de botella proactivamente, como un aumento inesperado en las transferencias FTP que podr√≠a indicar un ataque de fuerza bruta.

Las actualizaciones autom√°ticas con unattended-upgrades son otra capa de defensa, parcheando vulnerabilidades cr√≠ticas sin requerir supervisi√≥n constante. En entornos de alta disponibilidad, incluso un breve tiempo de inactividad puede impactar la experiencia del usuario, por lo que probar actualizaciones en un entorno de staging antes de aplicarlas en producci√≥n es una pr√°ctica recomendada.

## Soluci√≥n de Problemas con Enfoque Pedag√≥gico

Cuando un usuario reporta un error 550 Permission Denied al subir archivos, el proceso de diagn√≥stico debe ser met√≥dico. Primero, verificar los permisos del directorio con **ls -ld /var/ftp/innovatetech/pelis:** si el grupo no es innovatech o los permisos no son 775, el servidor FTP denegar√° la escritura. Segundo, confirmar que el usuario pertenece al grupo mediante groups innovatetech_admin. Si el problema persiste, examinar los logs de ProFTPD **(/var/log/proftpd/proftpd.log)** puede revelar mensajes como "WRITE denied", indicando reglas de firewall mal configuradas o conflictos con SELinux/AppArmor.

Este enfoque no solo resuelve el incidente inmediato, sino que entrena al equipo en t√©cnicas gen√©ricas de diagn√≥stico‚Äî√∫til para futuros errores no documentados. Por ejemplo, un error 421 Service Not Available suele indicar que ProFTPD no est√° en ejecuci√≥n, pero tambi√©n podr√≠a deberse a puertos bloqueados o dependencias faltantes. La capacidad de diferenciar entre estas causas requiere comprender c√≥mo interact√∫an los componentes del sistema, algo que una gu√≠a puramente procedimental no ense√±a.

## Conclusi√≥n y Consideraciones Futuras

La implementaci√≥n descrita trasciende la mera instalaci√≥n de un servidor FTP. Es un sistema integrado que abarca desde la seguridad perimetral (firewalls, FTPS) hasta la automatizaci√≥n de procesos (scripts de conversi√≥n, backups). Cada decisi√≥n t√©cnica‚Äîdesde la elecci√≥n de puertos pasivos hasta la herencia de grupos con **chmod g+s‚Äî** est√° orientada a sostener una operaci√≥n fluida y segura de la plataforma de streaming.
En futuras iteraciones, consideraciones como la migraci√≥n a IPv6, la integraci√≥n con autenticaci√≥n LDAP/Active Directory, o la adopci√≥n de almacenamiento distribuido (como AWS EFS) podr√≠an explorarse. Sin embargo, la base establecida aqu√≠‚Äîdocumentaci√≥n clara, seguridad por capas y automatizaci√≥n‚Äîproporciona una fundaci√≥n s√≥lida para escalar sin comprometer la estabilidad.


<p align="center">
  <img src="img3/extra/direcotrios_ftp.png" alt="i1">
</p>


<p align="center">
  <img src="img3/extra/put_pelicula.png" alt="i1">
</p>


<p align="center">
  <img src="img3/extra/get_peli.png" alt="i1">
</p>


---
# Servicio de Chatbot para Soporte T√©cnico y Atenci√≥n al Cliente

## Desarrollo e implementaci√≥n de un bot de soporte automatizado mediante Telegram.

En un entorno profesional de servicios digitales como el de una empresa de streaming de audio y video, el √°rea de soporte t√©cnico desempe√±a un rol clave tanto para la continuidad operativa como para la experiencia del usuario final. Debido a la criticidad de los servicios ofrecidos ‚Äîprincipalmente por su naturaleza 24/7, su dependencia del ancho de banda y su arquitectura distribuida‚Äî, es com√∫n encontrarse con un volumen importante de incidencias repetitivas, las cuales muchas veces pueden ser resueltas mediante respuestas automatizadas. En este contexto, la implementaci√≥n de un bot de mensajer√≠a automatizado, utilizando Telegram como plataforma de mensajer√≠a y Python como lenguaje de programaci√≥n, se convierte en una soluci√≥n viable, escalable y segura para la gesti√≥n inicial de incidencias t√©cnicas.

### Creaci√≥n del bot en Telegram

El proceso comienza con la creaci√≥n del bot en la plataforma de Telegram. Telegram proporciona una interfaz automatizada a trav√©s de un bot interno llamado **@BotFather**, el cual permite registrar nuevos bots mediante comandos. A trav√©s de este canal, el administrador puede definir el nombre del bot, su identificador √∫nico y, lo m√°s importante, obtener el token de autenticaci√≥n que servir√° como clave privada para acceder a la API de Telegram. Este token es sensible, por lo tanto, se recomienda almacenarlo en un fichero externo .env o bien declararlo como variable de entorno en el sistema operativo, evitando as√≠ la exposici√≥n directa en el c√≥digo fuente.

- Abre Telegram y busca el bot oficial @BotFather.
- Escribe el comando /newbot y sigue las instrucciones:

Ingresa un nombre visible para tu bot (por ejemplo: SoporteInnovateTechBot).

Ingresa un nombre de usuario √∫nico que termine en bot (por ejemplo: InnovateSupportBot).

- Una vez creado, @BotFather te enviar√° un token de autenticaci√≥n, necesario para comunicarte con la API de Telegram.

‚ö†Ô∏è Importante: Guarda este token en un archivo .env o como variable de entorno del sistema para evitar su exposici√≥n en el c√≥digo fuente.

### Entorno de desarrollo

Una vez obtenidas las credenciales, se procede con la preparaci√≥n del entorno de desarrollo y ejecuci√≥n. Para este proyecto se eligi√≥ el sistema operativo Ubuntu Server en su versi√≥n LTS m√°s reciente, ya que proporciona un entorno estable, seguro y ampliamente utilizado en entornos de producci√≥n. El lenguaje de programaci√≥n seleccionado fue Python, debido a su madurez, simplicidad y el amplio soporte de librer√≠as tanto para operaciones de red como para el consumo de APIs REST. En concreto, se utiliz√≥ la librer√≠a **python-telegram-bot**, en su versi√≥n as√≠ncrona (v20+), que permite aprovechar mejor los recursos del sistema y manejar m√∫ltiples usuarios concurrentemente sin bloquear procesos.

### Entorno virtual

Antes de escribir el c√≥digo, se debe preparar un entorno virtual utilizando venv. Esto se hace con el objetivo de aislar las dependencias del bot respecto al sistema operativo base, evitando conflictos con otras aplicaciones o versiones de librer√≠as. La activaci√≥n del entorno virtual asegura que cualquier instalaci√≥n de paquetes se realice en un directorio aislado. Dentro de este entorno se procede a instalar la librer√≠a principal del bot, junto con otras dependencias necesarias como aiohttp para posibles integraciones futuras con APIs externas.

**Instala Python y pip si a√∫n no lo tienes**:

```bash
sudo apt update
 
sudo apt install python3 python3-pip python3-venv
```

**Crea un entorno virtual para aislar las dependencias del proyecto**:

```bash
python3 -m venv venv

source venv/bin/activate
```

**Instala las librer√≠as necesarias**:

```bash
pip install python-telegram-bot aiohttp python-dotenv
```

### C√≥digo del bot

En cuanto al dise√±o l√≥gico del bot, este se construye a trav√©s de una serie de funciones que representan distintos estados de conversaci√≥n o flujos de decisi√≥n. Por ejemplo, al recibir el comando /start, el bot responde con un mensaje de bienvenida y presenta un men√∫ de opciones utilizando botones interactivos. Cada bot√≥n est√° vinculado a una funci√≥n espec√≠fica que procesa la elecci√≥n del usuario y lo gu√≠a por una rama distinta del √°rbol de decisiones. Estos flujos est√°n pensados para cubrir las principales incidencias reportadas, como problemas de conexi√≥n, errores en la reproducci√≥n de video o mal funcionamiento del sistema. En cada paso, el bot eval√∫a la entrada del usuario y decide si puede proporcionar una soluci√≥n directamente o si debe derivar la consulta a un t√©cnico humano.

Una de las particularidades de este dise√±o es que toda la interfaz conversacional est√° desarrollada bajo principios UX, utilizando texto claro, iconograf√≠a mediante emojis para facilitar la interpretaci√≥n, y formato enriquecido con Markdown. Adem√°s, el sistema est√° preparado para limitar el uso √∫nicamente a usuarios previamente autorizados, lo que refuerza la seguridad del sistema y evita accesos no deseados.

[Contenido del Script del bot](https://docs.google.com/document/d/1ciAYTOS3JlcPLpn8Etczm83AJyZDRWpCtDJiNXGFcy8/edit?usp=sharing)

**As√≠ es como queda el c√≥digo de nuestro script en la instancia**:

<p align="center">
  <img src="img3/bot/code1.png" alt="i1">
</p>


<p align="center">
  <img src="img3/bot/code2.png" alt="i1">
</p>


<p align="center">
  <img src="img3/bot/code3.png" alt="i1">
</p>

<p align="center">
  <img src="img3/bot/code4.png" alt="i1">
</p>

<p align="center">
  <img src="img3/bot/code5.png" alt="i1">
</p>

<p align="center">
  <img src="img3/bot/code6.png" alt="i1">
</p>

<p align="center">
  <img src="img3/bot/code7.png" alt="i1">
</p>

<p align="center">
  <img src="img3/bot/code8.png" alt="i1">
</p>


### Configuraci√≥n del bot como servicio

Para garantizar que el bot funcione de manera persistente y autom√°tica, incluso tras reinicios del sistema o ca√≠das inesperadas, se configura como un servicio gestionado por systemd. Este proceso comienza con la redacci√≥n de un archivo de unidad que describe c√≥mo debe ejecutarse el bot, qu√© usuario del sistema debe hacerlo, cu√°l es su directorio de trabajo, y qu√© acciones tomar en caso de errores. El uso de Restart=always en el fichero de configuraci√≥n garantiza que cualquier fallo en el script desencadenar√° un reinicio autom√°tico del servicio tras unos segundos. Esta estrategia es fundamental para entornos CPD donde la disponibilidad es un requisito cr√≠tico.

La activaci√≥n del servicio se realiza a trav√©s de los comandos de systemd, que permiten registrar el servicio en el arranque del sistema y verificar su estado en tiempo real. Adem√°s, los logs generados por el bot son capturados por journalctl, lo que facilita su monitorizaci√≥n, an√°lisis y trazabilidad ante incidencias.


**Crea el archivo de servicio systemd**:

```bash
sudo nano /etc/systemd/system/telegrambot.service
```

**Contenido del archivo**:

```ini
[Unit]
Description=Bot de soporte Telegram
After=network.target

[Service]
User=ubuntu
WorkingDirectory=/home/ubuntu/soporte-bot
ExecStart=/home/ubuntu/soporte-bot/venv/bin/python3 /home/ubuntu/soporte-bot/bot.py
Restart=always

[Install]
WantedBy=multi-user.target
```

**Habilita y lanza el servicio**:

```bash
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl enable telegrambot
sudo systemctl start telegrambot
```

**Verifica el estado del bot**:

```bash
sudo systemctl status telegrambot
```


<p align="center">
  <img src="img3/bot/status.png" alt="i1">
</p>

### Seguridad y administraci√≥n

Desde el punto de vista de la seguridad y la administraci√≥n de sistemas, se han adoptado una serie de pr√°cticas recomendadas. En primer lugar, todo el tr√°fico entre el usuario y el bot est√° cifrado por el protocolo de Telegram, y el bot √∫nicamente responde a comandos definidos, minimizando los vectores de ataque. En segundo lugar, se implementa un control de acceso b√°sico basado en el identificador del usuario, bloqueando cualquier interacci√≥n de actores no autorizados. Por √∫ltimo, se contempla la posibilidad de a√±adir sistemas de alerta autom√°ticos que env√≠en notificaciones al administrador cuando ocurren errores cr√≠ticos, o incluso se podr√≠an establecer integraciones con herramientas como Prometheus o Zabbix para enviar alertas en tiempo real sobre fallos en los sistemas del CPD.

### Posibles extensiones

Una vez implementado el sistema b√°sico, el bot puede ser extendido f√°cilmente. Se puede conectar con una base de datos para registrar cada conversaci√≥n y generar estad√≠sticas, se puede dise√±ar una interfaz de administraci√≥n para revisar los historiales, o incluso se puede desplegar en contenedores Docker para facilitar su portabilidad y escalabilidad. Otra mejora futura es el reemplazo del sistema de polling por el uso de webhooks, que permite al bot recibir actualizaciones en tiempo real mediante un servidor HTTPS, eliminando as√≠ la necesidad de consultas constantes a los servidores de Telegram, lo cual mejora el rendimiento y reduce el consumo de recursos.

## Funcionamiento


<p align="center">
  <img src="img3/bot/texto_prueba1.png" alt="i1">
</p>


<p align="center">
  <img src="img3/bot/texto_prueba2.png" alt="i1">
</p>


<p align="center">
  <img src="img3/bot/texto_prueba3.png" alt="i1">
</p>


<p align="center">
  <img src="img3/bot/texto_prueba3.png" alt="i1">
</p>


---

[**‚¨ÜÔ∏èSubir**](#inicio)                                     [**√çndice**](../../README.md){: .btn .btn-primary .float-right} 
